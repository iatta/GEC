<div *ngIf="show"  class="kt-container  kt-container--fluid  kt-grid__item kt-grid__item--fluid">
    <div class="row" [busyIf]="dataIsLoading" >
        <div class="col-lg-12">
            <div class="kt-portlet">
                <div class="kt-portlet__head">
                    <div class="kt-portlet__head-label">
                        <h3 class="kt-portlet__head-title">{{"SummerizeReportProjectManager" | localize}}</h3>
                    </div>
                </div>
                <div class="col-lg-12">
                    <div class="form-group row">
                        <div class="col-lg-3">
                            <label for="Project">{{l("Project")}}</label>
                            <p-dropdown styleClass="form-control" [options]="projectList" [(ngModel)]="selectedProject" name="selectedProject"  #selectedProjectInput="ngModel" placeholder="Select a Project" optionLabel="nameEn" [showClear]="true"></p-dropdown>
                        </div>
                        <div class="col-lg-3">
                            <label for="EmployeeType">{{l("EmployeeType")}}</label>
                            <p-dropdown styleClass="form-control" [options]="userTypes" [(ngModel)]="selectedUserType" name="selectedUserType"  #selectedUserTypeInput="ngModel" placeholder="Select Type" optionLabel="label" [showClear]="true"></p-dropdown>
                        </div>
                        <div class="col-lg-3">
                            <label for="TimeProfile_StartDate">{{l("Date")}}</label>
                            <input required class="form-control" autocomplete="off" bsDatepicker  [bsConfig]="{ dateInputFormat: 'MM/YYYY',isAnimated: true }" [(ngModel)]="selectedDate" id="selectedDate" name="selectedDate" (onShown)="onOpenCalendar($event)">
                        </div>
                        <div class="col-lg-3" style="margin-top: auto;">
                            <button class="btn btn-success" type="button" (click)="generateReport()" >Generate</button>
                        </div>
                    </div>

                </div>

                    <div class="col-lg-12" style="margin-bottom: 20px;" *ngIf="dataLoaded">

                        <p-panel header="Informations" [toggleable]="true" [style]="{'margin-bottom':'20px'}">
                            <div class="row">
                                <div class="col-lg-3 row" style="max-width: 12%;">
                                    <div class="col-lg-2">
                                        <div class="colorInfo late"></div>
                                    </div>
                                    <div class="col-lg-1">
                                        <p>{{l('Late')}}</p>
                                    </div>


                                </div>
                                <div class="col-lg-3 row" style="max-width: 12%;">
                                    <div class="col-lg-2">
                                        <div class="colorInfo overTime"></div>
                                    </div>
                                    <div class="col-lg-1">
                                        <p>{{l('Overtime')}}</p>
                                    </div>


                                </div>
                                <div class="col-lg-3 row"></div>
                                <div class="col-lg-3 row">
                                    <button type="button" (click)="approve()"  class="btn btn-success mr-2">{{l('Approve')}}</button>
                                    <!-- <button type="button" (click)="reject()" class="btn btn-danger mr-2">{{l('Reject')}}</button> -->
                                </div>
                            </div>

                        </p-panel>

                        <p-table [lazy]="!dataIsLoading"  [paginator]="true" [rows]="1" [responsive]="true" [resizableColumns]="true" columnResizeMode="expand"  [columns]="cols" [value]="data">

                            <ng-template pTemplate="header" let-columns>
                                <tr >
                                    <th style="width: 180px;text-align: center;" rowspan="2" *ngFor="let col of columns">
                                        {{col.header}}
                                    </th>
                                    <th  colspan="9" style="width:900px;text-align: center;background-color: #c5b3b3 !important;">
                                        {{l('summarize')}}
                                    </th>

                                </tr>
                                <tr>
                                    <th style="width:100px;background-color: #c5b3b3 !important;">
                                        {{l('Attendance')}}
                                    </th>
                                    <th style="width:100px;background-color: #c5b3b3 !important;">
                                        {{l('Hur. Deduction')}}
                                    </th>
                                    <th style="width:100px;background-color: #c5b3b3 !important;">
                                        {{l('Sick leave')}}
                                    </th>
                                    <th style="width:100px;background-color: #c5b3b3 !important;">
                                        {{l('Absence')}}
                                    </th>
                                    <th style="width:100px;background-color: #c5b3b3 !important;">
                                        {{l('A. leave / Day')}}
                                    </th>
                                    <th style="width:100px;background-color: #c5b3b3 !important;">
                                        {{l('OT - Normal')}}
                                    </th>
                                    <th style="width:100px;background-color: #c5b3b3 !important;">
                                        {{l('OT - Friday')}}
                                    </th>
                                    <th style="width:100px;background-color: #c5b3b3 !important;">
                                        {{l('OT - Holidayes')}}
                                    </th>
                                    <th style="width:100px;background-color: #c5b3b3 !important;">
                                        {{l('FOT')}}
                                    </th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-rowData let-columns="columns">
                                <tr [@rowsAnimation]="">

                                        <td class="center" *ngFor="let col of columns">

                                                <ng-container *ngIf="!isDate(col.field)" >
                                                    {{rowData[col.field]}}
                                                </ng-container>
                                                <ng-container *ngIf="isDate(col.field)">
                                                    <div style="width: 100%;"  *ngIf="rowData.details[col.field]['totalHours'] > 0 && rowData.details[col.field]['isWorkInAnotherProject'] == false"  [ngClass]="{'late' :rowData.details[col.field]['isDelay'] == true,'overTime':rowData.details[col.field]['overtime'] >0 }">
                                                        {{l('Total Hours : ')}} {{rowData.details[col.field]['totalHours'] | minutesToTime24}}
                                                        <ng-container *ngIf="rowData.details[col.field]['delay'] > 0">
                                                           <br>  {{l('Late : ')}}   {{rowData.details[col.field]['delay'] | minutesToString}}
                                                        </ng-container>
                                                        <ng-container *ngIf="rowData.details[col.field]['overtime'] > 0">
                                                            <br> {{l('Overtime : ')}}  {{rowData.details[col.field]['overtime'] | minutesToString}}
                                                         </ng-container>
                                                         <div>
                                                            <a style="margin-top: 10px;" type="button" class="btn btn-warning" (click)="openCreateOrEditTransaction(rowData.details[col.field]['inTransactionId'],rowData.details[col.field]['outTransactionId'],rowData.details[col.field]['day'],rowData.userId)" >{{l('Edit')}}</a>
                                                         </div>

                                                    </div>
                                                    <div style="display: grid;" *ngIf="rowData.details[col.field]['totalHours'] == 0  && rowData.details[col.field]['isWorkInAnotherProject'] == false">
                                                        <span>{{l('A')}}</span>
                                                        <a style="margin-top: 10px;" type="button" class="btn btn-warning" (click)="openCreateOrEditTransaction(rowData.details[col.field]['inTransactionId'],rowData.details[col.field]['outTransactionId'],rowData.details[col.field]['day'],rowData.userId)">{{l('Add')}}</a>
                                                    </div>
                                                    <div *ngIf="rowData.details[col.field]['isWorkInAnotherProject'] == true" >
                                                        {{l('Work In Another Project')}}
                                                    </div>
                                                </ng-container>



                                        </td>
                                        <td style="background-color: #c5b3b3 !important;">{{rowData.totalAttendance | minutesToTime24}}</td>
                                        <td style="background-color: #c5b3b3 !important;">{{rowData.totalDeductionHours | minutesToTime24}}</td>
                                        <td style="background-color: #c5b3b3 !important;">{{rowData.totalSickLeaveHours }}</td>
                                        <td style="background-color: #c5b3b3 !important;">{{rowData.totalaAbsenceHours }}</td>
                                        <td style="background-color: #c5b3b3 !important;"> {{rowData.totalLeaveHours}}</td>
                                        <td style="background-color: #c5b3b3 !important;">{{rowData.totalOverTimeNormal | minutesToTime24}}</td>
                                        <td style="background-color: #c5b3b3 !important;">{{rowData.totalOverTimeFriday | minutesToTime24}}</td>
                                        <td style="background-color: #c5b3b3 !important;">{{rowData.totalOverTimeHolidays | minutesToTime24}}</td>
                                        <td style="background-color: #c5b3b3 !important;">{{rowData.totalFOT | minutesToTime24}}</td>
                                </tr>

                            </ng-template>
                            <ng-template pTemplate="footer">
                                <tr style="text-align: center;">
                                    <td [attr.colspan]="summeryRowSpan">{{l('Total Summary')}}</td>
                                    <td>{{response.totalAttendanceHours | minutesToTime24}}</td>
                                    <td>{{response.totalDeductioneHours | minutesToTime24}}</td>
                                    <td>{{response.totalSickLeaveHours}}</td>
                                    <td>{{response.totalAbsenceHours}}</td>
                                    <td>{{response.totalLeaveDayHours}}</td>
                                    <td>{{response.totalOvertimeHours | minutesToTime24}}</td>
                                    <td>{{response.totalOvertimeFriday }}</td>
                                    <td>{{response.totalOvertimeHoliday}}</td>
                                    <td>{{response.totalFOT}}</td>
                                </tr>
                            </ng-template>

                        </p-table>
                    </div>



        </div>
        </div>
    </div>
</div>
<createOrEditAttendanceModal #createOrEditAttendanceModal></createOrEditAttendanceModal>
